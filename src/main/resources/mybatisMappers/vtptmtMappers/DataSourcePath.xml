<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vtest.it.dao.vtptmtmapperdao.GetDataSourceConfigDao">
    <resultMap id="list" type="com.vtest.it.pojo.datainfortomes.DataInforToMesBean">
        <result property="customCode" column="custom_code"/>
        <result property="device" column="device"/>
    </resultMap>
    <resultMap id="itemsCheck" type="com.vtest.it.pojo.propertiescheckItemBean.CheckItemBean">
        <result property="property" column="property"/>
        <result property="checkIsNa" column="check_NA"/>
        <result property="equalsItem" column="check_equals"/>
        <result property="customCode" column="custom_code"/>
        <result property="level" column="issue_level"/>
    </resultMap>
    <resultMap id="markToPassConfigMap" type="com.vtest.it.pojo.marktopassmodel.MarkToPassConfigBean">
        <result property="customerCode" column="customer_code"/>
        <result property="device" column="device"/>
        <result property="lot" column="lot"/>
        <result property="cp" column="cp"/>
        <result property="waferId" column="wafer_id"/>
        <result property="platform" column="platform"/>
        <result property="modelId" column="model_id"/>
    </resultMap>
    <select id="getConfig" resultType="com.vtest.it.pojo.DataSourceBean">
      SELECT source_path ,backup_source_path,backup_source_path_by_cp,rawdata_path FROM VTPTMT.data_source WHERE  platform=#{platform};
    </select>
    <select id="getList" resultMap="list">
        SELECT custom_code,device FROM VTPTMT.mes_data_from;
    </select>
    <select id="getCheckItemList" resultMap="itemsCheck">
        SELECT property,check_NA,check_equals,custom_code,issue_level FROM  VTPTMT.rawdata_properties_check_items;
    </select>
    <insert id="dataErrorsRecord">
        INSERT INTO VTPTMT.data_issue_record(custom_code, device, lot_id, cp_step, wafer_no,resource,issue_type, issue_level, issue_path, issue_description, deal_flag)
         VALUES
         <trim suffix="" suffixOverrides=",">
             <foreach collection="list" item="errorBean">
                 (#{errorBean.customCode},#{errorBean.device},#{errorBean.lotId},#{errorBean.cpStep},#{errorBean.waferNo},#{errorBean.resource},#{errorBean.issueType},#{errorBean.issuLevel},#{errorBean.issuePath},#{errorBean.issueDescription},#{errorBean.dealFlag}),
             </foreach>
         </trim>;
    </insert>
    <select id="getMarkAndSkipToPassConfig" resultType="com.vtest.it.pojo.MarkAndSkipToPassBean">
        SELECT custom_code,device FROM VTPTMT.mark_and_skip_to_pass;
    </select>
    <insert id="addNewModel" parameterType="com.vtest.it.pojo.marktopassmodel.MarkToPassModelBean">
        INSERT INTO VTPTMT.mark_to_pass_model_source(model_id, description, source_file, model_path) VALUE (#{modelId},#{description},#{sourceFile},#{modelPath}) ON DUPLICATE KEY UPDATE description=#{description},source_file=#{sourceFile},model_path=#{modelPath};
    </insert>
    <select id="getModel" resultType="com.vtest.it.pojo.marktopassmodel.MarkToPassModelBean">
        SELECT * FROM  VTPTMT.mark_to_pass_model_source WHERE model_id=#{modelId}
    </select>
    <select id="getMarkToPassConfigs" resultMap="markToPassConfigMap">
        SELECT customer_code,device,lot,cp,wafer_id,platform,model_id FROM VTPTMT.mark_to_ink_by_Special_model;
    </select>
</mapper>